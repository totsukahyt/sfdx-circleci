<!-- (c) 2012 Sunbridge Inc. -->
<apex:page standardController="SmartViscaf__NameCard__c" recordSetVar="nameCardList" extensions="SB_NameCard_LeadBulkRegistController" title="名刺: リードに一括登録" tabStyle="SmartViscaf__NameCard__c" showHeader="true" sidebar="false">
	<apex:pageMessages id="pageMsgs" escape="false"/>

	<apex:form >
		<apex:pageBlock title="リードに一括登録">
			<apex:pageBlockButtons >
				<apex:commandButton action="{!save}" value="保存" rerender="pageMsgs, ncRecList"/>
				<apex:commandButton action="{!cancel}" value="キャンセル" immediate="true"/>
			</apex:pageBlockButtons>

			<apex:pageBlockSection columns="2">
				<apex:selectRadio value="{!searchType}">
					<apex:selectOptions value="{!searchTypeList}"/>
					<apex:actionSupport event="onclick" action="{!search}" rerender="pageMsgs, ncRecList"/>
				</apex:selectRadio>

				<apex:outputPanel >
					<apex:inputCheckbox value="{!leadOverwrite}"/>
					<apex:outputLabel value="既存のリードの情報を名刺情報で上書きする"/>
				</apex:outputPanel>
			</apex:pageBlockSection>

			<apex:pageBlockTable id="ncRecList" value="{!nameCardRecordList}" var="ncRec">
				<apex:column rendered="{!hasError}">
					<apex:facet name="header"></apex:facet>
					<apex:image value="/img/msg_icons/error16.png" rendered="{!ncRec.hasError}"/>
				</apex:column>

				<apex:column >
					<apex:facet name="header">氏名</apex:facet>
					<apex:outputPanel layout="none">
						<a href="/{!ncRec.nameCard.Id}" id="ncNm_{!ncRec.nameCard.Id}" onblur="LookupHoverDetail.getHover('ncNm_{!ncRec.nameCard.Id}').hide();" onfocus="LookupHoverDetail.getHover('ncNm_{!ncRec.nameCard.Id}', '/{!ncRec.nameCard.Id}/m?isAjaxRequest=1').show();" onmouseout="LookupHoverDetail.getHover('ncNm_{!ncRec.nameCard.Id}').hide();" onmouseover="LookupHoverDetail.getHover('ncNm_{!ncRec.nameCard.Id}', '/{!ncRec.nameCard.Id}/m?isAjaxRequest=1').show();">
							<apex:outputText value="{!ncRec.nameCard.Name}"/>
						</a>
					</apex:outputPanel>
				</apex:column>

				<apex:column >
					<apex:facet name="header">メールアドレス</apex:facet>
					<apex:outputText value="{!ncRec.nameCard.SmartViscaf__email__c}"/>
				</apex:column>

				<apex:column >
					<apex:facet name="header">会社名</apex:facet>
					<apex:outputText value="{!ncRec.nameCard.SmartViscaf__company_name__c}"/>
				</apex:column>

				<apex:column >
					<apex:facet name="header">都道府県</apex:facet>
					<apex:outputText value="{!ncRec.nameCard.SmartViscaf__address_pref__c}"/>
				</apex:column>

				<apex:column >
					<apex:facet name="header">所属</apex:facet>
					<apex:outputText value="{!ncRec.nameCard.SmartViscaf__division__c}"/>
				</apex:column>

				<apex:column >
					<apex:facet name="header">役職</apex:facet>
					<apex:outputText value="{!ncRec.nameCard.SmartViscaf__title_name__c}"/>
				</apex:column>

				<apex:column >
					<apex:facet name="header">リード</apex:facet>
					<apex:selectList value="{!ncRec.leadId}" size="1">
						<apex:selectOptions value="{!ncRec.leadSelOptList}"/>
					</apex:selectList>
				</apex:column>

				<apex:column >
					<apex:facet name="header">ToDo登録</apex:facet>
					<apex:inputCheckbox value="{!ncRec.registTodo}"/>
				</apex:column>
			</apex:pageBlockTable>

			<apex:pageBlockSection title="新規作成時の指定" columns="1">
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="キャンペーン"/>
					<apex:inputField value="{!insertOption.campaign__c}"/>
				</apex:pageBlockSectionItem>

				<apex:pageBlockSectionItem >
					<apex:outputLabel value="所有者"/>
					<apex:inputField value="{!insertOption.OwnerId}" required="false"/>
				</apex:pageBlockSectionItem>
			</apex:pageBlockSection>
		</apex:pageBlock>
	</apex:form>
</apex:page>