"use strict";angular.module("SB_NameCard_SfdcServices",[]).factory("$sfdcService",function(){return{getSVConfig:function(n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getSVConfig",function(e,t){t.status?n(e):a(t)},{buffer:!1,escape:!1,timeout:12e4})},searchNameCardsEx:function(e,t,n,a,o,i,r){var s={apexType:apexController+".SearchRequest",word:t,index:n,target:e,userId:a,page:o};Visualforce.remoting.Manager.invokeAction(apexController+".searchNameCardsEx",s,function(e,t){t.status?i(e):r(t)},{buffer:!1,escape:!1,timeout:12e4})},getTagdNameCards:function(n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getTagdNameCards",function(e,t){t.status?n(e):a(t)},{buffer:!1,escape:!1,timeout:12e4})},getNameCardList:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getNameCardList",e,function(e,t){t.status?n(e):a(t)},{buffer:!1,escape:!1,timeout:12e4})},getNameCard:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getNameCard",e,function(e,t){t.status?n(e):a(t)},{buffer:!1,escape:!1,timeout:12e4})},getNameCardDetail:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getNameCardDetail",e,function(e,t){t.status?n(e):a(t)},{buffer:!1,escape:!1,timeout:12e4})},getTagsOrListnames:function(e,t,n,a){var o={apexType:apexController+".GetTagsRequest",type:e,tagSecurity:1,excludeId:t};Visualforce.remoting.Manager.invokeAction(apexController+".getTagsOrListnames",o,function(e,t){t.status?n(e):a(t)},{escape:!1})},saveNameCardTag:function(e,t,n,a){var o=new Array;o.push(t),Visualforce.remoting.Manager.invokeAction(apexController+".saveNameCardTag",e,o,function(e,t){t.status?n(e):a(t)},{escape:!1})},getUsersHavingCard:function(e,t,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getUsersHavingCard",e,t,function(e,t){t.status?n(e):a(t)},{escape:!1})},getUsersHavingCardEx:function(e,t,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getUsersHavingCardEx",e,t,function(e,t){t.status?n(e):a(t)},{escape:!1})},getMyActivities:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getMyActivities",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},getCompnayTree:function(e,t,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getCompnayTree2",e,t,function(e,t){t.status?n(e):a(t)},{escape:!1})},saveNameCards:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".saveNameCards",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},deleteNameCards:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".deleteNameCards",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},removeNameCardTag:function(e,t,n,a,o){var i=new Array;i.push(e),Visualforce.remoting.Manager.invokeAction(apexController+".removeNameCardTag",i,t,n,function(e,t){t.status?a(e):o(t)},{escape:!1})},getNameCardsWithoutLabel:function(e,t,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getNameCardsWithoutLabel",e,t,function(e,t){t.status?n(e):a(t)},{escape:!1})},bindNameCardsToLabel:function(e,t,n,a,o){var i={apexType:apexController+".TaggingRequest",labels:[],tagIsTag:n,nameCardIds:[]};i.labels.push(t),i.nameCardIds.push(e),Visualforce.remoting.Manager.invokeAction(apexController+".bindNameCardsToLabel",i,function(e,t){t.status?a(e):o(t)},{escape:!1})},getActivity:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getActivity",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},getTaskStatusOptions:function(n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getTaskStatusOptions",function(e,t){t.status?n(e):a(t)},{escape:!1})},getActivitySubject:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getActivitySubject",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},saveActivities:function(e,n,a){var t=new Array;t.push(e),Visualforce.remoting.Manager.invokeAction(apexController+".saveActivities",t,function(e,t){t.status?n(e):a(t)},{escape:!1})},deleteSObject:function(e,n,a){var t=new Array;t.push(e),Visualforce.remoting.Manager.invokeAction(apexController+".deleteSObjects",t,function(e,t){t.status?n(e):a(t)},{escape:!1})},getReferenced:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getReferenced",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},getSameCards:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getSameCards",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},getRecordTypes:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getRecordTypes",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},getUserProfile:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getUserProfile",e,function(e,t){t.status?n(e):a(t)},{escape:!1})},getDepartmentUsers:function(e,t,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".getDepartmentUsers",e,t,function(e,t){t.status?n(e):a(t)},{buffer:!1,escape:!1,timeout:12e4})},sendVerificationInfo:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".sendVerificationInfo",e,function(e,t){t.status?n(e):a(t)},{buffer:!1,escape:!1,timeout:12e4})},saveUserSetting:function(e,n,a){Visualforce.remoting.Manager.invokeAction(apexController+".saveUserSetting",e,function(e,t){t.status?n(e):a(t)},{buffer:!1,escape:!1,timeout:12e4})}}}),angular.module("SB_NameCard_SfdcGeoServices",[]).factory("$sfdcGeoService",["$q","$rootScope","$filter",function(e,n,a){return{getFindNearby:function(e,t,n,a){var o={apexType:apexController+".FindNearbyRequest",mineOnly:e,latitude:0,longitude:0,target:t};if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(e){o.latitude=e.coords.latitude,o.longitude=e.coords.longitude,Visualforce.remoting.Manager.invokeAction(apexController+".getFindNearby",o,function(e,t){t.status?(console.log(e),n(o.latitude,o.longitude,e)):t.type},{escape:!0})});else{lat=37.77493,lng=-122.419416;n(o.latitude,o.longitude,[])}},getFindNearbyEx:function(e,t,n,a){var o={apexType:apexController+".FindNearbyRequest",mineOnly:e,latitude:0,longitude:0,target:t};if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(e){o.latitude=e.coords.latitude,o.longitude=e.coords.longitude,Visualforce.remoting.Manager.invokeAction(apexController+".getFindNearbyEx",o,function(e,t){t.status?(console.log(e),n(o.latitude,o.longitude,e)):t.type},{escape:!0})});else{lat=37.77493,lng=-122.419416;n(o.latitude,o.longitude,[])}},getFindNearbyDefer:function(){var t=e.defer();return setTimeout(function(){n.$apply(function(){try{navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){e.coords.longitude;t.resolve({lng:e.coords.longitude,lat:e.coords.latitude})},function(e){t.reject(e)}):t.reject(a("translate")("M_DisableGps"))}catch(e){t.reject(e)}})},1e3),t.promise}}}]).factory("$svModal",["$log","$uibModal","$window",function(e,n,c){return{openLoading:function(){return n.open({animation:!1,template:"&nbsp;",windowTemplateUrl:"loadingWindow.html",size:"sm",backdrop:!0})},openImageModal:function(e,t){!function(n,e,a){var o=c.innerWidth,i=c.innerHeight,r=new Image,s={imageId:n.img.imageId,deg:0,scaleFactor:1,offsetX:"0px",offsetY:"0px"};r.onload=function(){var e,t;r.width>r.height?(e=r.height>o?o/r.height:1,t=r.width>i?i/r.width:1,s.scaleFactor=Math.min(e,t),s.deg=-90,s.offsetX=50-Math.ceil(r.width*s.scaleFactor)+"px"):(e=r.width>o?o/r.width:1,t=r.height>i?i/r.height:1,s.scaleFactor=Math.min(e,t),s.deg=0,s.offsetX="0px",s.offsetY=Math.ceil(Math.min(r.height,c.innerHeight)*s.scaleFactor-Math.max(r.height,c.innerHeight))+"px"),s.offsetY="0px",n.img=s,a()},r.src=e}(e,t,function(){n.open({templateUrl:"imgContent.html",controller:"ImageModalCtrl",scope:e,backdrop:!1,windowClass:"modalFrame modalBody img-modal-window",size:"sm"})})},openImage:function(e){n.open({animation:!0,backdrop:!0,scope:e,templateUrl:"imageWindow.html",controller:"OpenImageCtrl",windowClass:"modalFrame modalBody",size:"lg"})}}}]).controller("ImageModalCtrl",["$scope","$log","$uibModalInstance",function(e,t,n){e.tapped=function(e){e.target;n.dismiss("cancel")}}]).controller("OpenImageCtrl",["$scope","$log","$uibModalInstance",function(t,n,a){function e(){t.scaleFactor=1,t.posX=0,t.posY=0,o=t.card.width,i=t.card.height,n.info("imgW:"+o+" imgH"+i)}var o,i;t.paned=function(e){n.info("event.deltaX: "+e.deltaX+" event.deltaY: "+e.deltaY),n.info("event.element.parent().width(): "+e.element.parent().width()+" event.element.parent().height(): "+e.element.parent().height()),n.info("imgW:"+o+" imgH"+i),t.scaleFactor*o>e.element.parent().width()&&(t.posX=Math.max(t.posX+e.deltaX,e.element.parent().width()-t.scaleFactor*o),t.posX=Math.min(t.posX,0)),t.scaleFactor*i>e.element.parent().height()-42&&(t.posY=Math.max(t.posY+e.deltaY,e.element.parent().height()-42-t.scaleFactor*i),t.posY=Math.min(t.posY,0))},t.pinched=function(e){n.info(e.type),1<e.scale||(t.scaleFactor=e.scale)},t.tapped=function(e){n.info(e),a.dismiss()},t.reverse=function(){t.front&&null!=t.card.back&&(t.front=!t.front,e())},e()}]);